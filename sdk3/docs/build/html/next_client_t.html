
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>next_client_t &#8212; Network Next SDK 3.4.5 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="next_server_t" href="next_server_t.html" />
    <link rel="prev" title="Reference" href="reference.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="next-client-t">
<h1>next_client_t<a class="headerlink" href="#next-client-t" title="Permalink to this headline">¶</a></h1>
<p>The client side of a client/server connection.</p>
<p>To use a client, create it, open a session to the server address and start sending packets.</p>
<p>Packets received from the server are passed to you via a callback function.</p>
<p>Make sure you pump the client update once per frame.</p>
<p><strong>Examples:</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="simple_client_example.html"><span class="doc">Simple Client Example</span></a></p></li>
<li><p><a class="reference internal" href="upgraded_client_example.html"><span class="doc">Upgraded Client Example</span></a></p></li>
<li><p><a class="reference internal" href="complex_client_example.html"><span class="doc">Complex Client Example</span></a></p></li>
</ul>
<div class="section" id="next-client-create">
<h2>next_client_create<a class="headerlink" href="#next-client-create" title="Permalink to this headline">¶</a></h2>
<p>Creates an instance of a client, binding a socket to the specified address and port.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">next_client_t</span> <span class="o">*</span> <span class="nf">next_client_create</span><span class="p">(</span> <span class="kt">void</span> <span class="o">*</span> <span class="n">context</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">bind_address</span><span class="p">,</span>
                                    <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">packet_received_callback</span><span class="p">)(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span> <span class="n">context</span><span class="p">,</span> <span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span> <span class="n">packet_data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">packet_bytes</span> <span class="p">),</span>
                                    <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">wake_up_callback</span><span class="p">)(</span> <span class="kt">void</span> <span class="o">*</span> <span class="n">context</span> <span class="p">)</span> <span class="p">);</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>context</strong> – An optional pointer to context passed to any callbacks made from the client.</p></li>
<li><p><strong>bind_address</strong> – An address string describing the bind address and port to bind to. Typically “0.0.0.0:0” is passed in, which binds to any IPv4 interface and lets the system pick a port. Alternatively, you can bind to a specific port, for example: “0.0.0.0:50000”.</p></li>
<li><p><strong>packet_received_callback</strong> – Called from the same thread that calls <em>next_client_update</em>, whenever a packet is received from the server. Required.</p></li>
<li><p><strong>wake_up_callback</strong> – Optional callback. Pass NULL if not used. Sets a callback function to be called from an internal network next thread when a packet is ready to be received for this client. Intended to let you set an event of your own creation when a packet is ready to receive, making it possible to use Network Next with applications built around traditional select or wait for multiple event style blocking socket loops. Call next_client_update to pump received packets to the packet_received_callback when you wake up on your main thread from your event.</p></li>
</ul>
</div></blockquote>
<p><strong>Return value:</strong></p>
<blockquote>
<div><p>The newly created client instance, or NULL, if the client could not be created.</p>
<p>Typically, NULL is only returned when another socket is already bound on the same port, or if an invalid bind address is passed in.</p>
</div></blockquote>
<p><strong>Example:</strong></p>
<p>First define a callback for received packets:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">client_packet_received</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span> <span class="n">context</span><span class="p">,</span> <span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span> <span class="n">packet_data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">packet_bytes</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;client received packet from server (%d bytes)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">packet_bytes</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then, create a client:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span> <span class="o">=</span> <span class="n">next_client_create</span><span class="p">(</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;0.0.0.0:0&quot;</span><span class="p">,</span> <span class="n">client_packet_received</span> <span class="p">);</span>
<span class="k">if</span> <span class="p">(</span> <span class="n">client</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;error: failed to create client</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-destroy">
<h2>next_client_destroy<a class="headerlink" href="#next-client-destroy" title="Permalink to this headline">¶</a></h2>
<p>Destroys a client instance, and the socket it manages internally.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">next_client_destroy</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span> <span class="p">);</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>client</strong> – The client instance to destroy. Must be a valid client instance created by <em>next_client_create</em>. Do not pass in NULL.</p></li>
</ul>
</div></blockquote>
<p><strong>Example:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">next_client_destroy</span><span class="p">(</span> <span class="n">client</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-port">
<h2>next_client_port<a class="headerlink" href="#next-client-port" title="Permalink to this headline">¶</a></h2>
<p>Gets the port the client socket is bound to.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">uint16_t</span> <span class="nf">next_client_port</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span> <span class="p">);</span>
</pre></div>
</div>
<p><strong>Return value:</strong></p>
<blockquote>
<div><p>The port number the client socket is bound to.</p>
<p>This makes it possible to look up what specific port the client is bound to when you bind to port zero and the system chooses a port.</p>
</div></blockquote>
<p><strong>Example:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span> <span class="o">=</span> <span class="n">next_client_create</span><span class="p">(</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;0.0.0.0:0&quot;</span><span class="p">,</span> <span class="n">client_packet_received</span> <span class="p">);</span>
<span class="k">if</span> <span class="p">(</span> <span class="n">client</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot;error: failed to create client</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">const</span> <span class="kt">uint16_t</span> <span class="n">client_port</span> <span class="o">=</span> <span class="n">next_client_port</span><span class="p">(</span> <span class="n">client</span> <span class="p">);</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot;the client was bound to port %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">client_port</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-open-session">
<h2>next_client_open_session<a class="headerlink" href="#next-client-open-session" title="Permalink to this headline">¶</a></h2>
<p>Opens a session between the client and a server.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">next_client_open_session</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span><span class="p">,</span>
                               <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">server_address</span> <span class="p">)</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>client</strong> – The client instance.</p></li>
<li><p><strong>server_address</strong> – The address of the server that the client wants to connect to.</p></li>
</ul>
</div></blockquote>
<p><strong>Example:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">next_client_open_session</span><span class="p">(</span> <span class="n">client</span><span class="p">,</span> <span class="s">&quot;127.0.0.1:50000&quot;</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-close-session">
<h2>next_client_close_session<a class="headerlink" href="#next-client-close-session" title="Permalink to this headline">¶</a></h2>
<p>Closes the session between the client and server.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="n">next_client_close_session</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span> <span class="p">)</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>client</strong> – The client instance.</p></li>
</ul>
</div></blockquote>
<p><strong>Example:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">next_client_close_session</span><span class="p">(</span> <span class="n">client</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-is-session-open">
<h2>next_client_is_session_open<a class="headerlink" href="#next-client-is-session-open" title="Permalink to this headline">¶</a></h2>
<p>Check if the client has a session open.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span> <span class="nf">next_client_is_session_open</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span> <span class="p">);</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>client</strong> – The client instance.</p></li>
</ul>
</div></blockquote>
<p><strong>Return value:</strong></p>
<blockquote>
<div><p>True, if the client has an open session with a server, false otherwise.</p>
</div></blockquote>
<p><strong>Example:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="kt">bool</span> <span class="n">session_open</span> <span class="o">=</span> <span class="n">next_client_session_open</span><span class="p">(</span> <span class="n">client</span> <span class="p">);</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot;session open = %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">session_open</span> <span class="o">?</span> <span class="s">&quot;yes&quot;</span> <span class="o">:</span> <span class="s">&quot;no&quot;</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-state">
<h2>next_client_state<a class="headerlink" href="#next-client-state" title="Permalink to this headline">¶</a></h2>
<p>Gets the state the client is in.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">next_client_state</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span> <span class="p">);</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>client</strong> – The client instance.</p></li>
</ul>
</div></blockquote>
<p><strong>Return value:</strong></p>
<blockquote>
<div><p>The client state is either:</p>
<blockquote>
<div><ul class="simple">
<li><p>NEXT_CLIENT_STATE_CLOSED</p></li>
<li><p>NEXT_CLIENT_STATE_OPEN</p></li>
<li><p>NEXT_CLIENT_STATE_ERROR</p></li>
</ul>
</div></blockquote>
<p>The client is initially in closed state. After <em>next_client_open_session</em> the client is immediately in open state on success, or error state if something went wrong while opening the session, for example, an invalid server address was passed in.</p>
</div></blockquote>
<p><strong>Example:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">state</span> <span class="o">=</span> <span class="s">&quot;???&quot;</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">client_state</span> <span class="o">=</span> <span class="n">next_client_state</span><span class="p">(</span> <span class="n">client</span> <span class="p">);</span>

<span class="k">switch</span> <span class="p">(</span> <span class="n">client_state</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">case</span> <span class="nl">NEXT_CLIENT_STATE_CLOSED</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="s">&quot;closed&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">NEXT_CLIENT_STATE_OPEN</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="s">&quot;open&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">NEXT_CLIENT_STATE_ERROR</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="s">&quot;error&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">default</span><span class="o">:</span>
        <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot;client state = %s (%d)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">client_state</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-update">
<h2>next_client_update<a class="headerlink" href="#next-client-update" title="Permalink to this headline">¶</a></h2>
<p>Updates the client.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">next_client_update</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span> <span class="p">);</span>
</pre></div>
</div>
<p>Please call this every frame as it drives the packet received callback.</p>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>client</strong> – The client instance.</p></li>
</ul>
</div></blockquote>
<p><strong>Example:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="p">(</span> <span class="o">!</span><span class="n">quit</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">next_client_update</span><span class="p">(</span> <span class="n">client</span> <span class="p">);</span>

    <span class="c1">// ... do stuff ...</span>

    <span class="n">next_sleep</span><span class="p">(</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">60.0</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-send-packet">
<h2>next_client_send_packet<a class="headerlink" href="#next-client-send-packet" title="Permalink to this headline">¶</a></h2>
<p>Sends a packet to the server.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">next_client_send_packet</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span><span class="p">,</span> <span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span> <span class="n">packet_data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">packet_bytes</span> <span class="p">);</span>
</pre></div>
</div>
<p>Depending on whether this player is accelerated or not, this packet will be sent direct across the public internet, or through Network Next’s network of private networks.</p>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>client</strong> – The client instance.</p></li>
<li><p><strong>packet_data</strong> – The packet data to send to the server.</p></li>
<li><p><strong>packet_bytes</strong> – The size of the packet in bytes. Must be in range 1 to NEXT_MTU (1300).</p></li>
</ul>
</div></blockquote>
<p><strong>Example:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">uint8_t</span> <span class="n">packet_data</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
<span class="n">memset</span><span class="p">(</span> <span class="n">packet_data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span> <span class="n">packet_data</span> <span class="p">)</span> <span class="p">);</span>

<span class="k">while</span> <span class="p">(</span> <span class="o">!</span><span class="n">quit</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">next_client_update</span><span class="p">(</span> <span class="n">client</span> <span class="p">);</span>

    <span class="n">next_client_send_packet</span><span class="p">(</span> <span class="n">client</span><span class="p">,</span> <span class="n">packet_data</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">packet_data</span><span class="p">)</span> <span class="p">);</span>

    <span class="n">next_sleep</span><span class="p">(</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">60.0</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-send-packet-direct">
<h2>next_client_send_packet_direct<a class="headerlink" href="#next-client-send-packet-direct" title="Permalink to this headline">¶</a></h2>
<p>Sends a packet to the server, forcing the packet to be sent across the public internet.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">next_client_send_packet_direct</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span><span class="p">,</span> <span class="k">const</span> <span class="kt">uint8_t</span> <span class="o">*</span> <span class="n">packet_data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">packet_bytes</span> <span class="p">);</span>
</pre></div>
</div>
<p>The packet will be sent unaccelerated across the public internet and will not count towards your Network Next bandwidth envelope.</p>
<p>This can be very useful when you need to send a burst of non-latency sensitive packets, for example, in a load screen.</p>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>client</strong> – The client instance.</p></li>
<li><p><strong>packet_data</strong> – The packet data to send to the server.</p></li>
<li><p><strong>packet_bytes</strong> – The size of the packet in bytes. Must be in range 1 to NEXT_MTU (1300).</p></li>
</ul>
</div></blockquote>
<p>Example:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">uint8_t</span> <span class="n">packet_data</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
<span class="n">memset</span><span class="p">(</span> <span class="n">packet_data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span> <span class="n">packet_data</span> <span class="p">)</span> <span class="p">);</span>

<span class="k">while</span> <span class="p">(</span> <span class="o">!</span><span class="n">quit</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">next_client_update</span><span class="p">(</span> <span class="n">client</span> <span class="p">);</span>

    <span class="n">next_client_send_packet_direct</span><span class="p">(</span> <span class="n">client</span><span class="p">,</span> <span class="n">packet_data</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">packet_data</span><span class="p">)</span> <span class="p">);</span>

    <span class="n">next_sleep</span><span class="p">(</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">60.0</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-flag-session">
<h2>next_client_flag_session<a class="headerlink" href="#next-client-flag-session" title="Permalink to this headline">¶</a></h2>
<p>Flag the session as problematic.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">next_client_flag_session</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span> <span class="p">);</span>
</pre></div>
</div>
<p>This feature was added to support our customers who let players flag bad play sessions in their game UI.</p>
<p>Call this function when your players complain, and it’s sent to our backend so we can help you track down why!</p>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>client</strong> – The client instance.</p></li>
</ul>
</div></blockquote>
<p><strong>Example:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">next_client_report_session</span><span class="p">(</span> <span class="n">client</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-session-id">
<h2>next_client_session_id<a class="headerlink" href="#next-client-session-id" title="Permalink to this headline">¶</a></h2>
<p>Gets the client session id.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">uint64_t</span> <span class="nf">next_client_session_id</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span> <span class="p">);</span>
</pre></div>
</div>
<p>A session id uniquely identifies each session on Network Next.</p>
<p>Session ids are distinct from user ids. User ids are unique on a per-user basis, while session ids are unique for each call to <em>next_client_open_session</em>.</p>
<p>A session id is assigned when the server upgrades the session via <em>next_server_upgrade_session</em>. Until that point the session id is 0.</p>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>client</strong> – The client instance.</p></li>
</ul>
</div></blockquote>
<p><strong>Return value:</strong></p>
<blockquote>
<div><p>The session id, if the client has been upgraded, otherwise 0.</p>
</div></blockquote>
<p><strong>Example:</strong></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="kt">uint64_t</span> <span class="n">session_id</span> <span class="o">=</span> <span class="n">next_client_session_id</span><span class="p">(</span> <span class="n">client</span> <span class="p">);</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot;session id = %&quot;</span> <span class="n">PRIx64</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">session_id</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-stats">
<h2>next_client_stats<a class="headerlink" href="#next-client-stats" title="Permalink to this headline">¶</a></h2>
<p>Gets client statistics.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="n">next_client_stats_t</span> <span class="o">*</span> <span class="nf">next_client_stats</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span> <span class="p">);</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>client</strong> – The client instance.</p></li>
</ul>
</div></blockquote>
<p><strong>Return value:</strong></p>
<blockquote>
<div><p>A const pointer to the client stats struct.</p>
</div></blockquote>
<p><strong>Example:</strong></p>
<p>The client stats struct is defined as follows:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="n">next_client_stats_t</span>
<span class="p">{</span>
    <span class="kt">uint64_t</span> <span class="n">platform_id</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">connection_type</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">committed</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">multipath</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">flagged</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">direct_min_rtt</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">direct_max_rtt</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">direct_mean_rtt</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">direct_jitter</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">direct_packet_loss</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">next</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">next_min_rtt</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">next_max_rtt</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">next_mean_rtt</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">next_jitter</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">next_packet_loss</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">next_kbps_up</span><span class="p">;</span>
    <span class="kt">float</span> <span class="n">next_kbps_down</span><span class="p">;</span>
    <span class="kt">uint64_t</span> <span class="n">packets_sent_client_to_server</span><span class="p">;</span>
    <span class="kt">uint64_t</span> <span class="n">packets_sent_server_to_client</span><span class="p">;</span>
    <span class="kt">uint64_t</span> <span class="n">packets_lost_client_to_server</span><span class="p">;</span>
    <span class="kt">uint64_t</span> <span class="n">packets_lost_server_to_client</span><span class="p">;</span>
    <span class="kt">uint64_t</span> <span class="n">user_flags</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Here is how to query it, and print out various interesting values:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="n">next_client_stats_t</span> <span class="o">*</span> <span class="n">stats</span> <span class="o">=</span> <span class="n">next_client_stats</span><span class="p">(</span> <span class="n">client</span> <span class="p">);</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot;Client Stats:</span><span class="se">\n</span><span class="s">&quot;</span> <span class="p">);</span>

<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">platform</span> <span class="o">=</span> <span class="s">&quot;unknown&quot;</span><span class="p">;</span>

<span class="k">switch</span> <span class="p">(</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">platform_id</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">case</span> <span class="nl">NEXT_PLATFORM_WINDOWS</span><span class="p">:</span>
        <span class="n">platform</span> <span class="o">=</span> <span class="s">&quot;windows&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">NEXT_PLATFORM_MAC</span><span class="p">:</span>
        <span class="n">platform</span> <span class="o">=</span> <span class="s">&quot;mac&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">NEXT_PLATFORM_LINUX</span><span class="p">:</span>
        <span class="n">platform</span> <span class="o">=</span> <span class="s">&quot;linux&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">NEXT_PLATFORM_SWITCH</span><span class="p">:</span>
        <span class="n">platform</span> <span class="o">=</span> <span class="s">&quot;nintendo switch&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">NEXT_PLATFORM_PS4</span><span class="p">:</span>
        <span class="n">platform</span> <span class="o">=</span> <span class="s">&quot;ps4&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">NEXT_PLATFORM_IOS</span><span class="p">:</span>
        <span class="n">platform</span> <span class="o">=</span> <span class="s">&quot;ios&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">NEXT_PLATFORM_XBOX_ONE</span><span class="p">:</span>
        <span class="n">platform</span> <span class="o">=</span> <span class="s">&quot;xbox one&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">default</span><span class="o">:</span>
        <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">state</span> <span class="o">=</span> <span class="s">&quot;???&quot;</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">client_state</span> <span class="o">=</span> <span class="n">next_client_state</span><span class="p">(</span> <span class="n">client</span> <span class="p">);</span>

<span class="k">switch</span> <span class="p">(</span> <span class="n">client_state</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">case</span> <span class="nl">NEXT_CLIENT_STATE_CLOSED</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="s">&quot;closed&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">NEXT_CLIENT_STATE_OPEN</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="s">&quot;open&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">NEXT_CLIENT_STATE_ERROR</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="s">&quot;error&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">default</span><span class="o">:</span>
        <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + State = %s (%d)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">client_state</span> <span class="p">);</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Session Id = %&quot;</span> <span class="n">PRIx64</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">next_client_session_id</span><span class="p">(</span> <span class="n">client</span> <span class="p">)</span> <span class="p">);</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Platform = %s (%d)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">platform</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">platform_id</span> <span class="p">);</span>

<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">connection</span> <span class="o">=</span> <span class="s">&quot;unknown&quot;</span><span class="p">;</span>

<span class="k">switch</span> <span class="p">(</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">connection_type</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">case</span> <span class="nl">NEXT_CONNECTION_TYPE_WIRED</span><span class="p">:</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="s">&quot;wired&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">NEXT_CONNECTION_TYPE_WIFI</span><span class="p">:</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="s">&quot;wifi&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="nl">NEXT_CONNECTION_TYPE_CELLULAR</span><span class="p">:</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="s">&quot;cellular&quot;</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">default</span><span class="o">:</span>
        <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Connection = %s (%d)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">connection_type</span> <span class="p">);</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Committed = %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">committed</span> <span class="o">?</span> <span class="s">&quot;yes&quot;</span> <span class="o">:</span> <span class="s">&quot;no&quot;</span> <span class="p">);</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Multipath = %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">multipath</span> <span class="o">?</span> <span class="s">&quot;yes&quot;</span> <span class="o">:</span> <span class="s">&quot;no&quot;</span> <span class="p">);</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Flagged = %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">flagged</span> <span class="o">?</span> <span class="s">&quot;yes&quot;</span> <span class="o">:</span> <span class="s">&quot;no&quot;</span> <span class="p">);</span>

<span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Direct RTT = %.2fms</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">direct_min_rtt</span> <span class="p">);</span>
<span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Direct Jitter = %.2fms</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">direct_jitter</span> <span class="p">);</span>
<span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Direct Packet Loss = %.1f%%</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">direct_packet_loss</span> <span class="p">);</span>

<span class="k">if</span> <span class="p">(</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">next</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Next RTT = %.2fms</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">next_min_rtt</span> <span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Next Jitter = %.2fms</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">next_jitter</span> <span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Next Packet Loss = %.1f%%</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">next_packet_loss</span> <span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Next Bandwidth Up = %.1fkbps</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">next_kbps_up</span> <span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span> <span class="s">&quot; + Next Bandwidth Down = %.1fkbps</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">stats</span><span class="o">-&gt;</span><span class="n">next_kbps_down</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="next-client-set-user-flags">
<h2>next_client_set_user_flags<a class="headerlink" href="#next-client-set-user-flags" title="Permalink to this headline">¶</a></h2>
<p>Set user flags.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">next_client_set_user_flags</span><span class="p">(</span> <span class="n">next_client_t</span> <span class="o">*</span> <span class="n">client</span><span class="p">,</span> <span class="kt">uint64_t</span> <span class="n">user_flags</span> <span class="p">);</span>
</pre></div>
</div>
<p>This feature was added to allow you to define your own set of flags, mapping to important events in <em>your</em> game, and pass them up to our backend.</p>
<p>For example, you could define (1&lt;&lt;0) as “low framerate”, (1&lt;&lt;1) as “player died”, (1&lt;&lt;2) as “large frame hitch” and so on. Then, as we study reported sessions for your player base, our data scientists look for correlations with user flags you specify.</p>
<p><strong>Parameters:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>client</strong> – The client instance.</p></li>
<li><p><strong>user_flags</strong> – The current user flags value as defined by <em>you</em>.</p></li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Network Next SDK</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="how_it_works.html">How it works</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_the_sdk.html">Building the SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_client_example.html">Simple Client Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_server_example.html">Simple Server Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgraded_client_example.html">Upgraded Client Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgraded_server_example.html">Upgraded Server Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="complex_client_example.html">Complex Client Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="complex_server_example.html">Complex Server Example</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="reference.html">Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="reference.html">Reference</a><ul>
      <li>Previous: <a href="reference.html" title="previous chapter">Reference</a></li>
      <li>Next: <a href="next_server_t.html" title="next chapter">next_server_t</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Network Next, Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/next_client_t.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>